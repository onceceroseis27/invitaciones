<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduce tu código</title>
<style>
html, body { margin:0; padding:0; font-family:"Didot", serif; height:100%; width:100%; overflow:hidden; }
.page { position:relative; width:100%; height:100%; }
.bg-blur { position:absolute; inset:0; background:#f8f2ec; z-index:1; }
.code-container { position:absolute; bottom:3%; left:50%; transform:translateX(-50%); z-index:2; }
.code-box { background: rgba(255,255,255,0.9); padding:20px; border-radius:12px; text-align:center; width:250px; }
input { padding:10px 15px; border-radius:8px; border:1px solid #aaa; font-size:18px; width:200px; text-align:center; }
button { margin-left:10px; padding:10px 20px; font-size:18px; border-radius:8px; border:none; background:#d4b88c; cursor:pointer; }
</style>
</head>
<body>
<div class="page">
    <div class="bg-blur"></div>
    <div class="code-container">
        <div class="code-box">
            <p>Introduce tu código:</p>
            <input type="text" id="codigo" placeholder="XXXX">
            <button onclick="verificarCodigo()">Aceptar</button>
        </div>
    </div>
</div>
<script>
async function verificarCodigo() {
    const codigo = document.getElementById("codigo").value.trim();
    if(!codigo){ alert("Introduce un código"); return; }

    try{
        const resp = await fetch("/validar", {
            method:"POST",
            headers:{ "Content-Type":"application/json" },
            body: JSON.stringify({codigo})
        });
        const data = await resp.json();
        if(data.valido){
            document.body.innerHTML = `<div style="display:flex; justify-content:center; align-items:center; height:100vh; font-size:24px; text-align:center;">${data.mensaje}</div>`;
            setTimeout(()=>{ window.location.href = `invitacion.html?codigo=${codigo}`; }, 3000);
        }else{
            alert(data.mensaje);
        }
    }catch(e){
        console.error(e); alert("Error al conectar con el servidor");
    }
}
</script>
</body>
</html>
